<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RentBee â€” Sign Up</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f6f7fb;padding:30px}
.wrap{max-width:420px;margin:40px auto;background:white;padding:25px;border-radius:10px}
input{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #ccc}
button{width:100%;padding:12px;border:none;border-radius:6px;background:#45a049;color:white;margin-top:10px}
.oauth-btn{background:#db4437}
</style>
</head>
<body>

<div class="wrap">
<h2>Sign Up</h2>

<input id="name" placeholder="Full Name">
<input id="phone" placeholder="Phone Number">
<input id="email" placeholder="Email">
<input id="division" placeholder="Division">
<input id="password" type="password" placeholder="Password">

<button id="signupBtn">Sign Up</button>
<button class="oauth-btn" id="googleSignup">Continue with Gmail</button>

<p style="text-align:center;margin-top:12px">
Already have an account? <a href="login.html">Login</a>
</p>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, GoogleAuthProvider, signInWithPopup }
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, setDoc, doc } 
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCbKyDJwcUSMcfUcj0AvH-xVM64Jw3UB0M",
  authDomain: "ntbee-185f6.firebaseapp.com",
  projectId: "ntbee-185f6",
  storageBucket: "ntbee-185f6.appspot.com",
  messagingSenderId: "1023710538392",
  appId: "1:1023710538392:web:4a09e23d56f53b5cedfeed"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const google = new GoogleAuthProvider();

document.getElementById("signupBtn").onclick = async () => {
  const name = name.value;
  const phone = phone.value;
  const email = email.value;
  const division = division.value;
  const pass = password.value;
  const role = localStorage.getItem("selectedRole") || "none";

  try{
    const user = await createUserWithEmailAndPassword(auth, email, pass);
    await setDoc(doc(db, "users", user.user.uid), { name, phone, division, role, email });
    alert("Account created!");
    window.location.href = "login.html";
  }catch(e){ alert(e.message); }
};

document.getElementById("googleSignup").onclick = async () => {
  try{
    const user = await signInWithPopup(auth, google);
    const role = localStorage.getItem("selectedRole") || "none";
    await setDoc(doc(db, "users", user.user.uid), { 
      name: user.user.displayName,
      email: user.user.email,
      role
    });
    alert("Signed up with Gmail!");
    window.location.href = "login.html";
  }catch(e){ alert(e.message); }
};

</script>

</body>
</html>
